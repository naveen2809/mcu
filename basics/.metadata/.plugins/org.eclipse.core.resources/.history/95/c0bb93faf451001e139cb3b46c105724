/*
 * svc_testing.c
 *
 *  Created on: 13-Sep-2023
 *      Author: naveen
 */

#define GPIO_PIN_LED_1		GPIO_PIN_12
#define GPIO_PIN_LED_2		GPIO_PIN_13
#define GPIO_PIN_LED_3		GPIO_PIN_14
#define GPIO_PIN_LED_4		GPIO_PIN_15
#define SLEEP_COUNT 50000

void SVC_Handler(void);
void configure_leds(void);
void delay(void);

uint8_t GPIOPin;

int main(void)
{
	configure_leds();

	while(1)
	{
		__asm volatile ("SVC #1");
		delay();
	}
}

__attribute__ ((naked)) void SVC_Handler(void)
{




	/* Toggle LED */
	GPIOTogglePin(GPIOD, GPIOPin);

	/* Return from exception handler */
	__asm volatile ("BX LR");
}

void configure_leds(void)
{
	EnablePeriClk(GPIOD);
	GPIOSetMode(GPIOD, GPIO_PIN_LED_1, GPIO_MODE_OUTPUT);
	GPIOSetMode(GPIOD, GPIO_PIN_LED_2, GPIO_MODE_OUTPUT);
	GPIOSetMode(GPIOD, GPIO_PIN_LED_3, GPIO_MODE_OUTPUT);
	GPIOSetMode(GPIOD, GPIO_PIN_LED_4, GPIO_MODE_OUTPUT);
}

void delay(void)
{
	uint32_t j;
	for(j=0;j<SLEEP_COUNT;j++);
}

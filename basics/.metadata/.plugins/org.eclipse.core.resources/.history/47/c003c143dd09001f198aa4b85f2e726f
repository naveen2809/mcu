/*
 * w5500_driver.c
 *
 *  Created on: 04-May-2024
 *      Author: naveen
 */

#include <stdint.h>
#include "stm32f4xx.h"
#include "gpio_driver.h"
#include "spi_driver.h"
#include "common_utils.h"
#include "w5500_driver.h"

void w5500_configure_pins(void)
{
	//Configure the GPIO Pin for Slave Select Pin of FLASH Module
	EnablePeriClk(W5500_PORT);
	GPIOSetMode(W5500_PORT,SS_PIN,GPIO_MODE_OUTPUT);
	GPIOWritePin(W5500_PORT,SS_PIN,GPIO_HIGH);

	return;
}

uint8_t get_w5500_chip_version(void)
{

	uint8_t tx_buf[4];
	uint8_t rx_buf[4];

	tx_buf[0] = 0x00;
	tx_buf[1] = 0x39;
	tx_buf[2] = 0x00;
	tx_buf[3] = 0x00;

	GPIOWritePin(W5500_PORT,SS_PIN,GPIO_LOW);
	SPIMasterRecvData(SPI_DEV,tx_buf,rx_buf,4);
	GPIOWritePin(W5500_PORT,SS_PIN,GPIO_HIGH);

	return rx_buf[3];
}



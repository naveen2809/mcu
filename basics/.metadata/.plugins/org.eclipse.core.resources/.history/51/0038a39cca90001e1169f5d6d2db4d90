/*
 * general_purpose_timer.h
 *
 *  Created on: 02-Dec-2023
 *      Author: naveen
 */

#ifndef INC_GENERAL_PURPOSE_TIMER_H_
#define INC_GENERAL_PURPOSE_TIMER_H_

#include "stm32f4xx.h"


struct General_Purpose_Timer_RegDef_t
{
	uint32_t TIMx_CR1;
	uint32_t TIMx_CR2;
	uint32_t TIMx_SMCR;
	uint32_t TIMx_DIER;
	uint32_t TIMx_SR;
	uint32_t TIMx_EGR;
	uint32_t TIMx_CCMR1;
	uint32_t TIMx_CCMR2;
	uint32_t TIMx_CCER;
	uint32_t TIMx_CNT;
	uint32_t TIMx_PSC;
	uint32_t TIMx_ARR;
	uint32_t Reserved1;
	uint32_t TIMx_CCR1;
	uint32_t TIMx_CCR2;
	uint32_t TIMx_CCR3;
	uint32_t TIMx_CCR4;
	uint32_t Reserved2;
	uint32_t TIMx_DCR;
	uint32_t TIMx_DMAR;
	uint32_t TIM2_OR;
	uint32_t TIM5_OR;
};

struct General_Purpose_Timer_Config_t
{
	uint16_t Timer_PreScalerValue;
	uint16_t Timer_AutoReloadValue;
	uint16_t Timer_OnePulseModeConfig;
	uint16_t Timer_UpdateInterruptConfig;
};

struct General_Purpose_Timer_Handle_t
{
	struct General_Purpose_Timer_RegDef_t *pGeneral_Purpose_Timer;
	struct General_Purpose_Timer_Config_t General_Purpose_Timer_Config;
};

#define TIMx_CR1_CEN		0
#define TIMx_CR1_UDIS		1
#define TIMx_CR1_URS		2
#define TIMx_CR1_OPM		3
#define TIMx_CR1_ARPE		7

#define TIMx_CR2_MMS		4

#define TIMx_DIER_UIE		0
#define TIMx_DIER_UDE		8

#define TIMx_SR_UIF			0

#define TIMx_EGR_UG			0

#define TIMx_FLAG_UIF		(1 << TIMx_SR_UIF)

#define TIMER_UPDATE_INTERRUPT_ENABLE	1
#define TIMER_UPDATE_INTERRUPT_DISABLE	0

#define TIMER_ONE_PULSE_MODE_ENABLE		1
#define TIMER_ONE_PULSE_MODE_DISABLE	0

#define TIMER_UPDATE_INTERRUPT_DISABLE	0

void General_Purpose_Timer_Init(struct General_Purpose_Timer_Handle_t *pGeneral_Purpose_Timer_Handle);
void General_Purpose_Timer_PeripheralEnable(struct General_Purpose_Timer_Handle_t *pGeneral_Purpose_Timer_Handle);
void General_Purpose_Timer_PeripheralDisable(struct General_Purpose_Timer_Handle_t *pGeneral_Purpose_Timer_Handle);
void General_Purpose_Timer_EnableUpdateEventInterrupt(struct General_Purpose_Timer_Handle_t *pGeneral_Purpose_Timer_Handle);
void General_Purpose_Timer_DisableUpdateEventInterrupt(struct General_Purpose_Timer_Handle_t *pGeneral_Purpose_Timer_Handle);
void General_Purpose_Timer_ClearUpdateEventFlag(struct General_Purpose_Timer_Handle_t *pGeneral_Purpose_Timer_Handle);
void General_Purpose_Timer_SetARPEFlag(struct General_Purpose_Timer_Handle_t *pGeneral_Purpose_Timer_Handle);
void General_Purpose_Timer_IRQHandling(struct General_Purpose_Timer_Handle_t *pGeneral_Purpose_Timer_Handle);

#endif /* INC_GENERAL_PURPOSE_TIMER_H_ */
